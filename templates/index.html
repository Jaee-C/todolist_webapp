{% extends "layout.html" %}

{% block body %}

    <form action="/" method="post">
        <input type="text" autofocus autocomplete="off" id ="task_name" name="new_task" placeholder="New task">
        <input type="submit" name="add_task" class="btn btn-outline-primary" value="Add">
    </form>
    <form action="/" method="post">
    {% if entries %}
        {% for id, task, status in entries %}
            {% if status == "Incomplete" %}
                <div class="form-check" id="{{ id }}"> 
                    <input type="checkbox" class="form-check-input" onclick="toggleComplete('{{ id }}')"> 
                    <label class="form-check-label">{{ task }}</label><span onclick="deleteTask('{{ id }}')"><a class="close" href="#">&#10006;</a></span> 
                </div> 
            {% else %}
                <div class="form-check"> 
                    <input type="checkbox" class="form-check-input" onclick="toggleComplete('{{ task }}')" checked> 
                    <label class="form-check-label">{{ task }}</label><span class="close">&#10006;</span> 
                </div>
            {% endif %}
        {% endfor %}
    {% endif %}

    <script>
        function toggleComplete(id) {
            fetch(`/update-todo/${id}`, {
                method: 'post'
            });
        }

        function deleteTask(id) {
            document.getElementById(id).remove();
            fetch(`/delete-todo/${id}`, {
                method: 'post'
            });
        }

    </script>

{% endblock %}